<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: WIN32OLE_TYPELIB
  
    &mdash; Documentation by YARD 0.8.7.4
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!WIN32OLE_TYPELIB.html";
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index (W)</a> &raquo;
    
    
    <span class="title">WIN32OLE_TYPELIB</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: WIN32OLE_TYPELIB
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></li>
          
            <li class="next">WIN32OLE_TYPELIB</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">ext/win32ole/win32ole.c<span class="defines">,<br />
  ext/win32ole/win32ole.c</span>
</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p><code>WIN32OLE_TYPELIB</code> objects represent OLE tyblib information.</p>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#typelibs-class_method" title="typelibs (class method)">+ (Object) <strong>typelibs</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the array of WIN32OLE_TYPELIB object.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#guid-instance_method" title="#guid (instance method)">- (The guid string.) <strong>guid</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns guid string which specifies type library.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#new (instance method)">- (WIN32OLE_TYPELIB object) <strong>new</strong>(typelib[, version1, version2]) </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns a new WIN32OLE_TYPELIB object.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#inspect-instance_method" title="#inspect (instance method)">- (String) <strong>inspect</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the type library name with class name.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#library_name-instance_method" title="#library_name (instance method)">- (Object) <strong>library_name</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns library name.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#major_version-instance_method" title="#major_version (instance method)">- (The type library major version.) <strong>major_version</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the type library major version.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#minor_version-instance_method" title="#minor_version (instance method)">- (The type library minor version.) <strong>minor_version</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the type library minor version.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#name-instance_method" title="#name (instance method)">- (The type library name) <strong>name</strong> </a>
    

    
      (also: #to_s)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the type library name.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#ole_types-instance_method" title="#ole_types (instance method)">- (The array of WIN32OLE_TYPE object included the type library.) <strong>ole_types</strong> </a>
    

    
      (also: #ole_classes)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the type library file path.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#path-instance_method" title="#path (instance method)">- (The type library file path.) <strong>path</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the type library file path.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#version-instance_method" title="#version (instance method)">- (The type library version.) <strong>version</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the type library version.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#visible%3F-instance_method" title="#visible? (instance method)">- (Boolean) <strong>visible?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns true if the type library information is not hidden.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="WIN32OLE_TYPELIB (class)">WIN32OLE_TYPELIB</a></span> object</tt>) <strong>new</strong>(typelib[, version1, version2]) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a new WIN32OLE_TYPELIB object.</p>

<p>The first argument <em>typelib</em>  specifies OLE type library name or
GUID or OLE library file. The second argument is major version or version
of the type library. The third argument is minor version. The second
argument and third argument are optional. If the first argument is type
library name, then the second and third argument are ignored.</p>

<pre class="code"><code class=""><span class='id identifier rubyid_tlib1'>tlib1</span> <span class='op'>=</span> <span class='const'>WIN32OLE_TYPELIB</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Microsoft Excel 9.0 Object Library</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_tlib2'>tlib2</span> <span class='op'>=</span> <span class='const'>WIN32OLE_TYPELIB</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>{00020813-0000-0000-C000-000000000046}</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_tlib3'>tlib3</span> <span class='op'>=</span> <span class='const'>WIN32OLE_TYPELIB</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>{00020813-0000-0000-C000-000000000046}</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='float'>1.3</span><span class='rparen'>)</span>
<span class='id identifier rubyid_tlib4'>tlib4</span> <span class='op'>=</span> <span class='const'>WIN32OLE_TYPELIB</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>{00020813-0000-0000-C000-000000000046}</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='int'>3</span><span class='rparen'>)</span>
<span class='id identifier rubyid_tlib5'>tlib5</span> <span class='op'>=</span> <span class='const'>WIN32OLE_TYPELIB</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>C:\\WINNT\\SYSTEM32\\SHELL32.DLL</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_tlib1'>tlib1</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>  <span class='comment'># -&gt; 'Microsoft Excel 9.0 Object Library'
</span><span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_tlib2'>tlib2</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>  <span class='comment'># -&gt; 'Microsoft Excel 9.0 Object Library'
</span><span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_tlib3'>tlib3</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>  <span class='comment'># -&gt; 'Microsoft Excel 9.0 Object Library'
</span><span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_tlib4'>tlib4</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>  <span class='comment'># -&gt; 'Microsoft Excel 9.0 Object Library'
</span><span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_tlib5'>tlib5</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>  <span class='comment'># -&gt; 'Microsoft Shell Controls And Automation'</span></code></pre>


  </div>
</div>
<div class="tags">
  
  <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  

</div>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


5189
5190
5191
5192
5193
5194
5195
5196
5197
5198
5199
5200
5201
5202
5203
5204
5205
5206
5207
5208
5209
5210
5211
5212
5213
5214
5215
5216
5217
5218
5219
5220
5221
5222
5223
5224
5225
5226
5227</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/win32ole/win32ole.c', line 5189</span>

static VALUE
foletypelib_initialize(VALUE self, VALUE args)
{
    VALUE found = Qfalse;
    VALUE typelib = Qnil;
    int len = 0;
    OLECHAR * pbuf;
    ITypeLib *pTypeLib;
    HRESULT hr = S_OK;

    len = RARRAY_LEN(args);
    if (len &lt; 1 || len &gt; 3) {
        rb_raise(rb_eArgError, &quot;wrong number of arguments (%d for 1..3)&quot;, len);
    }

    typelib = rb_ary_entry(args, 0);

    SafeStringValue(typelib);

    found = oletypelib_search_registry(self, typelib);
    if (found == Qfalse) {
        found = oletypelib_search_registry2(self, args);
    }
    if (found == Qfalse) {
        pbuf = ole_vstr2wc(typelib);
        hr = LoadTypeLibEx(pbuf, REGKIND_NONE, &amp;pTypeLib);
        SysFreeString(pbuf);
        if (SUCCEEDED(hr)) {
	    found = Qtrue;
	    oletypelib_set_member(self, pTypeLib);
        }
    }

    if (found == Qfalse) {
        rb_raise(eWIN32OLERuntimeError, &quot;not found type library `%s`&quot;,
                 StringValuePtr(typelib));
    }
    return self;
}</pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="typelibs-class_method">
  
    + (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>typelibs</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the array of WIN32OLE_TYPELIB object.</p>

<pre class="code"><code class=""><span class='id identifier rubyid_tlibs'>tlibs</span> <span class='op'>=</span> <span class='const'>WIN32OLE_TYPELIB</span><span class='period'>.</span><span class='id identifier rubyid_typelibs'>typelibs</span></code></pre>


  </div>
</div>
<div class="tags">
  
  


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


4968
4969
4970
4971
4972
4973
4974
4975
4976
4977
4978
4979
4980
4981
4982
4983
4984
4985
4986
4987
4988
4989
4990
4991
4992
4993
4994
4995
4996
4997
4998
4999
5000
5001
5002
5003
5004
5005
5006
5007
5008
5009
5010</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/win32ole/win32ole.c', line 4968</span>

static VALUE
foletypelib_s_typelibs(VALUE self)
{
    HKEY htypelib, hguid;
    DWORD i, j;
    LONG err;
    VALUE guid;
    VALUE version;
    VALUE name = Qnil;
    VALUE typelibs = rb_ary_new();
    VALUE typelib = Qnil;
    HRESULT hr;
    ITypeLib *pTypeLib;

    err = reg_open_key(HKEY_CLASSES_ROOT, &quot;TypeLib&quot;, &amp;htypelib);
    if(err != ERROR_SUCCESS) {
        return typelibs;
    }
    for(i = 0; ; i++) {
        guid = reg_enum_key(htypelib, i);
        if (guid == Qnil)
            break;
        err = reg_open_vkey(htypelib, guid, &amp;hguid);
        if (err != ERROR_SUCCESS)
            continue;
        for(j = 0; ; j++) {
            version = reg_enum_key(hguid, j);
            if (version == Qnil)
                break;
            if ( (name = reg_get_val2(hguid, StringValuePtr(version))) != Qnil ) {
		hr = oletypelib_from_guid(guid, version, &amp;pTypeLib);
		if (SUCCEEDED(hr)) {
		    typelib = rb_funcall(cWIN32OLE_TYPELIB, rb_intern(&quot;allocate&quot;), 0);
		    oletypelib_set_member(typelib, pTypeLib);
		    rb_ary_push(typelibs, typelib);
		}
            }
        }
        RegCloseKey(hguid);
    }
    RegCloseKey(htypelib);
    return typelibs;
}</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="guid-instance_method">
  
    - (<tt>The guid string.</tt>) <strong>guid</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns guid string which specifies type library.</p>

<pre class="code"><code class=""><span class='id identifier rubyid_tlib'>tlib</span> <span class='op'>=</span> <span class='const'>WIN32OLE_TYPELIB</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Microsoft Excel 9.0 Object Library</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_guid'>guid</span> <span class='op'>=</span> <span class='id identifier rubyid_tlib'>tlib</span><span class='period'>.</span><span class='id identifier rubyid_guid'>guid</span> <span class='comment'># -&gt; '{00020813-0000-0000-C000-000000000046}'</span></code></pre>


  </div>
</div>
<div class="tags">
  
  <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>The guid string.</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


5238
5239
5240
5241
5242
5243
5244
5245
5246
5247
5248
5249
5250
5251
5252
5253
5254
5255</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/win32ole/win32ole.c', line 5238</span>

static VALUE
foletypelib_guid(VALUE self)
{
    ITypeLib *pTypeLib;
    OLECHAR bstr[80];
    VALUE guid = Qnil;
    int len;
    TLIBATTR *pTLibAttr;

    pTypeLib = oletypelib_get_typelib(self);
    oletypelib_get_libattr(pTypeLib, &amp;pTLibAttr);
    len = StringFromGUID2(&amp;pTLibAttr-&gt;guid, bstr, sizeof(bstr)/sizeof(OLECHAR));
    if (len &gt; 3) {
        guid = ole_wc2vstr(bstr, FALSE);
    }
    pTypeLib-&gt;lpVtbl-&gt;ReleaseTLibAttr(pTypeLib, pTLibAttr);
    return guid;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="inspect-instance_method">
  
    - (<tt><span class='object_link'><a href="String.html" title="String (class)">String</a></span></tt>) <strong>inspect</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the type library name with class name.</p>

<pre class="ruby"><span class="ruby-identifier">tlib</span> = <span class="ruby-constant">WIN32OLE_TYPELIB</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'Microsoft Excel 9.0 Object Library'</span>)
<span class="ruby-identifier">tlib</span>.<span class="ruby-identifier">inspect</span> <span class="ruby-comment"># =&gt; &quot;&lt;#WIN32OLE_TYPELIB:Microsoft Excel 9.0 Object Library&gt;&quot;</span>
</pre>


  </div>
</div>
<div class="tags">
  
  <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


5528
5529
5530
5531
5532</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/win32ole/win32ole.c', line 5528</span>

static VALUE
foletypelib_inspect(VALUE self)
{
    return default_inspect(self, &quot;WIN32OLE_TYPELIB&quot;);
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="library_name-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>library_name</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns library name. If the method fails to access library name,
WIN32OLERuntimeError is raised.</p>

<pre class="ruby"><span class="ruby-identifier">tlib</span> = <span class="ruby-constant">WIN32OLE_TYPELIB</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'Microsoft Excel 9.0 Object Library'</span>)
<span class="ruby-identifier">tlib</span>.<span class="ruby-identifier">library_name</span> <span class="ruby-comment"># =&gt; Excel</span>
</pre>


  </div>
</div>
<div class="tags">
  
  


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


5481
5482
5483
5484
5485
5486
5487
5488
5489
5490
5491
5492
5493
5494
5495
5496
5497</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/win32ole/win32ole.c', line 5481</span>

static VALUE
foletypelib_library_name(VALUE self)
{
    HRESULT hr;
    ITypeLib *pTypeLib = NULL;
    VALUE libname = Qnil;
    BSTR bstr;

    pTypeLib = oletypelib_get_typelib(self);
    hr = pTypeLib-&gt;lpVtbl-&gt;GetDocumentation(pTypeLib, -1,
                                            &amp;bstr, NULL, NULL, NULL);
    if (FAILED(hr)) {
        ole_raise(hr, eWIN32OLERuntimeError, &quot;failed to get library name&quot;);
    }
    libname = WC2VSTR(bstr);
    return libname;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="major_version-instance_method">
  
    - (<tt>The type library major version.</tt>) <strong>major_version</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the type library major version.</p>

<pre class="code"><code class=""><span class='id identifier rubyid_tlib'>tlib</span> <span class='op'>=</span> <span class='const'>WIN32OLE_TYPELIB</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Microsoft Excel 9.0 Object Library</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_tlib'>tlib</span><span class='period'>.</span><span class='id identifier rubyid_major_version'>major_version</span> <span class='comment'># -&gt; 1</span></code></pre>


  </div>
</div>
<div class="tags">
  
  <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>The type library major version.</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


5318
5319
5320
5321
5322
5323
5324
5325
5326
5327
5328
5329
5330</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/win32ole/win32ole.c', line 5318</span>

static VALUE
foletypelib_major_version(VALUE self)
{
    TLIBATTR *pTLibAttr;
    VALUE major;
    ITypeLib *pTypeLib;
    pTypeLib = oletypelib_get_typelib(self);
    oletypelib_get_libattr(pTypeLib, &amp;pTLibAttr);

    major =  INT2NUM(pTLibAttr-&gt;wMajorVerNum);
    pTypeLib-&gt;lpVtbl-&gt;ReleaseTLibAttr(pTypeLib, pTLibAttr);
    return major;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="minor_version-instance_method">
  
    - (<tt>The type library minor version.</tt>) <strong>minor_version</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the type library minor version.</p>

<pre class="code"><code class=""><span class='id identifier rubyid_tlib'>tlib</span> <span class='op'>=</span> <span class='const'>WIN32OLE_TYPELIB</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Microsoft Excel 9.0 Object Library</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_tlib'>tlib</span><span class='period'>.</span><span class='id identifier rubyid_minor_version'>minor_version</span> <span class='comment'># -&gt; 3</span></code></pre>


  </div>
</div>
<div class="tags">
  
  <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>The type library minor version.</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


5341
5342
5343
5344
5345
5346
5347
5348
5349
5350
5351
5352</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/win32ole/win32ole.c', line 5341</span>

static VALUE
foletypelib_minor_version(VALUE self)
{
    TLIBATTR *pTLibAttr;
    VALUE minor;
    ITypeLib *pTypeLib;
    pTypeLib = oletypelib_get_typelib(self);
    oletypelib_get_libattr(pTypeLib, &amp;pTLibAttr);
    minor =  INT2NUM(pTLibAttr-&gt;wMinorVerNum);
    pTypeLib-&gt;lpVtbl-&gt;ReleaseTLibAttr(pTypeLib, pTLibAttr);
    return minor;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="name-instance_method">
  
    - (<tt>The type library name</tt>) <strong>name</strong> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='to_s-instance_method'>to_s</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the type library name.</p>

<pre class="code"><code class=""><span class='id identifier rubyid_tlib'>tlib</span> <span class='op'>=</span> <span class='const'>WIN32OLE_TYPELIB</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Microsoft Excel 9.0 Object Library</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_tlib'>tlib</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='comment'># -&gt; 'Microsoft Excel 9.0 Object Library'</span></code></pre>


  </div>
</div>
<div class="tags">
  
  <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>The type library name</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


5266
5267
5268
5269
5270
5271
5272
5273
5274
5275
5276
5277
5278
5279
5280
5281
5282</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/win32ole/win32ole.c', line 5266</span>

static VALUE
foletypelib_name(VALUE self)
{
    ITypeLib *pTypeLib;
    HRESULT hr;
    BSTR bstr;
    VALUE name;
    pTypeLib = oletypelib_get_typelib(self);
    hr = pTypeLib-&gt;lpVtbl-&gt;GetDocumentation(pTypeLib, -1,
                                            NULL, &amp;bstr, NULL, NULL);

    if (FAILED(hr)) {
        ole_raise(hr, eWIN32OLERuntimeError, &quot;failed to get name from ITypeLib&quot;);
    }
    name = WC2VSTR(bstr);
    return rb_enc_str_new(StringValuePtr(name), strlen(StringValuePtr(name)), cWIN32OLE_enc);
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="ole_types-instance_method">
  
    - (<tt>The array of <span class='object_link'><a href="WIN32OLE_TYPE.html" title="WIN32OLE_TYPE (class)">WIN32OLE_TYPE</a></span> object included the type library.</tt>) <strong>ole_types</strong> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='ole_classes-instance_method'>ole_classes</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the type library file path.</p>

<pre class="ruby"><span class="ruby-identifier">tlib</span> = <span class="ruby-constant">WIN32OLE_TYPELIB</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'Microsoft Excel 9.0 Object Library'</span>)
<span class="ruby-identifier">classes</span> = <span class="ruby-identifier">tlib</span>.<span class="ruby-identifier">ole_types</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span> <span class="ruby-identifier">k</span>.<span class="ruby-identifier">name</span>} <span class="ruby-comment"># -&gt; ['AddIn', 'AddIns' ...]</span>
</pre>


  </div>
</div>
<div class="tags">
  
  <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>The array of <span class='object_link'><a href="WIN32OLE_TYPE.html" title="WIN32OLE_TYPE (class)">WIN32OLE_TYPE</a></span> object included the type library.</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


5509
5510
5511
5512
5513
5514
5515
5516
5517</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/win32ole/win32ole.c', line 5509</span>

static VALUE
foletypelib_ole_types(VALUE self)
{
    ITypeLib *pTypeLib = NULL;
    VALUE classes = rb_ary_new();
    pTypeLib = oletypelib_get_typelib(self);
    ole_types_from_typelib(pTypeLib, classes);
    return classes;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="path-instance_method">
  
    - (<tt>The type library file path.</tt>) <strong>path</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the type library file path.</p>

<pre class="code"><code class=""><span class='id identifier rubyid_tlib'>tlib</span> <span class='op'>=</span> <span class='const'>WIN32OLE_TYPELIB</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Microsoft Excel 9.0 Object Library</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_tlib'>tlib</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span> <span class='comment'>#-&gt; 'C:\...\EXCEL9.OLB'</span></code></pre>


  </div>
</div>
<div class="tags">
  
  <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>The type library file path.</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


5412
5413
5414
5415
5416
5417
5418
5419
5420
5421
5422
5423
5424
5425
5426
5427
5428
5429
5430
5431
5432
5433
5434
5435
5436
5437</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/win32ole/win32ole.c', line 5412</span>

static VALUE
foletypelib_path(VALUE self)
{
    TLIBATTR *pTLibAttr;
    HRESULT hr = S_OK;
    BSTR bstr;
    LCID lcid = cWIN32OLE_lcid;
    VALUE path;
    ITypeLib *pTypeLib;

    pTypeLib = oletypelib_get_typelib(self);
    oletypelib_get_libattr(pTypeLib, &amp;pTLibAttr);
    hr = QueryPathOfRegTypeLib(&amp;pTLibAttr-&gt;guid,
	                       pTLibAttr-&gt;wMajorVerNum,
			       pTLibAttr-&gt;wMinorVerNum,
			       lcid,
			       &amp;bstr);
    if (FAILED(hr)) {
	pTypeLib-&gt;lpVtbl-&gt;ReleaseTLibAttr(pTypeLib, pTLibAttr);
	ole_raise(hr, eWIN32OLERuntimeError, &quot;failed to QueryPathOfRegTypeTypeLib&quot;);
    }

    pTypeLib-&gt;lpVtbl-&gt;ReleaseTLibAttr(pTypeLib, pTLibAttr);
    path = WC2VSTR(bstr);
    return rb_enc_str_new(StringValuePtr(path), strlen(StringValuePtr(path)), cWIN32OLE_enc);
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="version-instance_method">
  
    - (<tt>The type library version.</tt>) <strong>version</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the type library version.</p>

<pre class="code"><code class=""><span class='id identifier rubyid_tlib'>tlib</span> <span class='op'>=</span> <span class='const'>WIN32OLE_TYPELIB</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Microsoft Excel 9.0 Object Library</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_tlib'>tlib</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span> <span class='comment'>#-&gt; 1.3</span></code></pre>


  </div>
</div>
<div class="tags">
  
  <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>The type library version.</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


5293
5294
5295
5296
5297
5298
5299
5300
5301
5302
5303
5304
5305
5306
5307</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/win32ole/win32ole.c', line 5293</span>

static VALUE
foletypelib_version(VALUE self)
{
    TLIBATTR *pTLibAttr;
    VALUE major;
    VALUE minor;
    ITypeLib *pTypeLib;

    pTypeLib = oletypelib_get_typelib(self);
    oletypelib_get_libattr(pTypeLib, &amp;pTLibAttr);
    major = INT2NUM(pTLibAttr-&gt;wMajorVerNum);
    minor = INT2NUM(pTLibAttr-&gt;wMinorVerNum);
    pTypeLib-&gt;lpVtbl-&gt;ReleaseTLibAttr(pTypeLib, pTLibAttr);
    return rb_Float(make_version_str(major, minor));
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="visible?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>visible?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns true if the type library information is not hidden. If wLibFlags of
TLIBATTR is 0 or LIBFLAG_FRESTRICTED or LIBFLAG_FHIDDEN, the method returns
false, otherwise, returns true. If the method fails to access the TLIBATTR
information, then WIN32OLERuntimeError is raised.</p>

<pre class="ruby"><span class="ruby-identifier">tlib</span> = <span class="ruby-constant">WIN32OLE_TYPELIB</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'Microsoft Excel 9.0 Object Library'</span>)
<span class="ruby-identifier">tlib</span>.<span class="ruby-identifier">visible?</span> <span class="ruby-comment"># =&gt; true</span>
</pre>


  </div>
</div>
<div class="tags">
  
  

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


5452
5453
5454
5455
5456
5457
5458
5459
5460
5461
5462
5463
5464
5465
5466
5467
5468
5469</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/win32ole/win32ole.c', line 5452</span>

static VALUE
foletypelib_visible(VALUE self)
{
    ITypeLib *pTypeLib = NULL;
    VALUE visible = Qtrue;
    TLIBATTR *pTLibAttr;

    pTypeLib = oletypelib_get_typelib(self);
    oletypelib_get_libattr(pTypeLib, &amp;pTLibAttr);

    if ((pTLibAttr-&gt;wLibFlags == 0) ||
        (pTLibAttr-&gt;wLibFlags &amp; LIBFLAG_FRESTRICTED) ||
        (pTLibAttr-&gt;wLibFlags &amp; LIBFLAG_FHIDDEN)) {
        visible = Qfalse;
    }
    pTypeLib-&gt;lpVtbl-&gt;ReleaseTLibAttr(pTypeLib, pTLibAttr);
    return visible;
}</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Wed Nov 19 10:17:05 2014 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.4 (ruby-1.9.3).
</div>

  </body>
</html>