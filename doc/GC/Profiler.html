<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Module: GC::Profiler
  
    &mdash; Documentation by YARD 0.8.7.4
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../';
  framesUrl = "../frames.html#!GC/Profiler.html";
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (P)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../GC.html" title="GC (module)">GC</a></span></span>
     &raquo; 
    <span class="title">Profiler</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Module: GC::Profiler
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">gc.c</dd>
  
</dl>
<div class="clear"></div>








  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#clear-class_method" title="GC::Profiler.clear (class method)">+ (nil) <strong>GC::Profiler.clear</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Clears the GC profiler data.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#disable-class_method" title="GC::Profiler.disable (class method)">+ (nil) <strong>GC::Profiler.disable</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Stops the GC profiler.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#enable-class_method" title="GC::Profiler.enable (class method)">+ (nil) <strong>GC::Profiler.enable</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Starts the GC profiler.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#enabled%3F-class_method" title="GC::Profiler.enable? (class method)">+ (Boolean) <strong>GC::Profiler.enable?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The current status of GC profile mode.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#report-class_method" title="report (class method)">+ (Object) <strong>report</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Writes the GC::Profiler#result to $stdout or the given IO object.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#result-class_method" title="GC::Profiler.result (class method)">+ (String) <strong>GC::Profiler.result</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns a profile data report such as:.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#total_time-class_method" title="GC::Profiler.total_time (class method)">+ (Float) <strong>GC::Profiler.total_time</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The total time used for garbage collection in milliseconds.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="clear-class_method">
  
    + (<tt>nil</tt>) <strong>GC::Profiler.clear</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Clears the GC profiler data.</p>


  </div>
</div>
<div class="tags">
  
  <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>nil</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


687
688
689
690
691
692
693
694</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'gc.c', line 687</span>

static VALUE
gc_profile_clear(void)
{
    rb_objspace_t *objspace = &amp;rb_objspace;
    MEMZERO(objspace-&gt;profile.record, gc_profile_record, objspace-&gt;profile.size);
    objspace-&gt;profile.count = 0;
    return Qnil;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="disable-class_method">
  
    + (<tt>nil</tt>) <strong>GC::Profiler.disable</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Stops the GC profiler.</p>


  </div>
</div>
<div class="tags">
  
  <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>nil</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


670
671
672
673
674
675
676
677</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'gc.c', line 670</span>

static VALUE
gc_profile_disable(void)
{
    rb_objspace_t *objspace = &amp;rb_objspace;

    objspace-&gt;profile.run = FALSE;
    return Qnil;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="enable-class_method">
  
    + (<tt>nil</tt>) <strong>GC::Profiler.enable</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Starts the GC profiler.</p>


  </div>
</div>
<div class="tags">
  
  <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>nil</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


653
654
655
656
657
658
659
660</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'gc.c', line 653</span>

static VALUE
gc_profile_enable(void)
{
    rb_objspace_t *objspace = &amp;rb_objspace;

    objspace-&gt;profile.run = TRUE;
    return Qnil;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="enabled?-class_method">
  
    + (<tt>Boolean</tt>) <strong>GC::Profiler.enable?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The current status of GC profile mode.</p>


  </div>
</div>
<div class="tags">
  
  <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


638
639
640
641
642
643</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'gc.c', line 638</span>

static VALUE
gc_profile_enable_get(VALUE self)
{
    rb_objspace_t *objspace = &amp;rb_objspace;
    return objspace-&gt;profile.run ? Qtrue : Qfalse;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="report-class_method">
  
    
      <span class="overload">+ (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>GC::Profiler.report</strong> </span>
    
      <span class="overload">+ (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>GC::Profiler.report</strong>(io) </span>
    
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Writes the GC::Profiler#result to <code>$stdout</code> or the given IO
object.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


3602
3603
3604
3605
3606
3607
3608
3609
3610
3611
3612
3613
3614
3615
3616</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'gc.c', line 3602</span>

static VALUE
gc_profile_report(int argc, VALUE *argv, VALUE self)
{
    VALUE out;

    if (argc == 0) {
	out = rb_stdout;
    }
    else {
	rb_scan_args(argc, argv, &quot;01&quot;, &amp;out);
    }
    rb_io_write(out, gc_profile_result());

    return Qnil;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="result-class_method">
  
    + (<tt><span class='object_link'><a href="../String.html" title="String (class)">String</a></span></tt>) <strong>GC::Profiler.result</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a profile data report such as:</p>

<pre class="code"><code class="">GC 1 invokes.
Index    Invoke Time(sec)       Use Size(byte)     Total Size(byte)         Total Object                    GC time(ms)
    1               0.012               159240               212940                10647         0.00000000000001530000</code></pre>


  </div>
</div>
<div class="tags">
  
  <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


3541
3542
3543
3544
3545
3546
3547
3548
3549
3550
3551
3552
3553
3554
3555
3556
3557
3558
3559
3560
3561
3562
3563
3564
3565
3566
3567
3568
3569
3570
3571
3572
3573
3574
3575
3576
3577
3578
3579
3580
3581
3582
3583
3584
3585
3586
3587
3588
3589
3590</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'gc.c', line 3541</span>

static VALUE
gc_profile_result(void)
{
    rb_objspace_t *objspace = &amp;rb_objspace;
    VALUE record;
    VALUE result;
    int i, index;

    record = gc_profile_record_get();
    if (objspace-&gt;profile.run &amp;&amp; objspace-&gt;profile.count) {
	result = rb_sprintf(&quot;GC %d invokes.\n&quot;, NUM2INT(gc_count(0)));
        index = 1;
	rb_str_cat2(result, &quot;Index    Invoke Time(sec)       Use Size(byte)     Total Size(byte)         Total Object                    GC Time(ms)\n&quot;);
	for (i = 0; i &lt; (int)RARRAY_LEN(record); i++) {
	    VALUE r = RARRAY_PTR(record)[i];
#if !GC_PROFILE_MORE_DETAIL
            if (rb_hash_aref(r, ID2SYM(rb_intern(&quot;GC_IS_MARKED&quot;)))) {
#endif
	    rb_str_catf(result, &quot;%5d %19.3f %20&quot;PRIuSIZE&quot; %20&quot;PRIuSIZE&quot; %20&quot;PRIuSIZE&quot; %30.20f\n&quot;,
			index++, NUM2DBL(rb_hash_aref(r, ID2SYM(rb_intern(&quot;GC_INVOKE_TIME&quot;)))),
			(size_t)NUM2SIZET(rb_hash_aref(r, ID2SYM(rb_intern(&quot;HEAP_USE_SIZE&quot;)))),
			(size_t)NUM2SIZET(rb_hash_aref(r, ID2SYM(rb_intern(&quot;HEAP_TOTAL_SIZE&quot;)))),
			(size_t)NUM2SIZET(rb_hash_aref(r, ID2SYM(rb_intern(&quot;HEAP_TOTAL_OBJECTS&quot;)))),
			NUM2DBL(rb_hash_aref(r, ID2SYM(rb_intern(&quot;GC_TIME&quot;))))*1000);
#if !GC_PROFILE_MORE_DETAIL
            }
#endif
	}
#if GC_PROFILE_MORE_DETAIL
	rb_str_cat2(result, &quot;\n\n&quot;);
	rb_str_cat2(result, &quot;More detail.\n&quot;);
	rb_str_cat2(result, &quot;Index Allocate Increase    Allocate Limit  Use Slot  Have Finalize             Mark Time(ms)            Sweep Time(ms)\n&quot;);
        index = 1;
	for (i = 0; i &lt; (int)RARRAY_LEN(record); i++) {
	    VALUE r = RARRAY_PTR(record)[i];
	    rb_str_catf(result, &quot;%5d %17&quot;PRIuSIZE&quot; %17&quot;PRIuSIZE&quot; %9&quot;PRIuSIZE&quot; %14s %25.20f %25.20f\n&quot;,
			index++, (size_t)NUM2SIZET(rb_hash_aref(r, ID2SYM(rb_intern(&quot;ALLOCATE_INCREASE&quot;)))),
			(size_t)NUM2SIZET(rb_hash_aref(r, ID2SYM(rb_intern(&quot;ALLOCATE_LIMIT&quot;)))),
			(size_t)NUM2SIZET(rb_hash_aref(r, ID2SYM(rb_intern(&quot;HEAP_USE_SLOTS&quot;)))),
			rb_hash_aref(r, ID2SYM(rb_intern(&quot;HAVE_FINALIZE&quot;)))? &quot;true&quot; : &quot;false&quot;,
			NUM2DBL(rb_hash_aref(r, ID2SYM(rb_intern(&quot;GC_MARK_TIME&quot;))))*1000,
			NUM2DBL(rb_hash_aref(r, ID2SYM(rb_intern(&quot;GC_SWEEP_TIME&quot;))))*1000);
	}
#endif
    }
    else {
	result = rb_str_new2(&quot;&quot;);
    }
    return result;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="total_time-class_method">
  
    + (<tt><span class='object_link'><a href="../Float.html" title="Float (class)">Float</a></span></tt>) <strong>GC::Profiler.total_time</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The total time used for garbage collection in milliseconds</p>


  </div>
</div>
<div class="tags">
  
  <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Float.html" title="Float (class)">Float</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


3625
3626
3627
3628
3629
3630
3631
3632
3633
3634
3635
3636
3637
3638</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'gc.c', line 3625</span>

static VALUE
gc_profile_total_time(VALUE self)
{
    double time = 0;
    rb_objspace_t *objspace = &amp;rb_objspace;
    size_t i;

    if (objspace-&gt;profile.run &amp;&amp; objspace-&gt;profile.count) {
	for (i = 0; i &lt; objspace-&gt;profile.count; i++) {
	    time += objspace-&gt;profile.record[i].gc_time;
	}
    }
    return DBL2NUM(time);
}</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Wed Nov 19 10:16:21 2014 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.4 (ruby-1.9.3).
</div>

  </body>
</html>